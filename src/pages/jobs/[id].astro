---
import {JOBS, getJobById} from 'src/staticpaths/jobs';
import Tag from "@components/Tag.astro";
import Metadata from "@components/Metadata.astro";
import Layout from "@layouts/Layout.astro";
import {fade} from "astro:transitions";
import Carousel from "../../components/Carousel.astro";
import type {Asset} from "../../types/Asset";

export async function getStaticPaths() {
    return JOBS.map((job) => {
        return {
            params: {
                id: job.id
            },
            props: {
                url: job.href
            }
        }
    })
}

const {id} = Astro.params
const {url} = Astro.props
const {
    name,
    backgroundUrl,
    logo,
    roles,
    tags,
    description,
    transitionName
} = getJobById(id)

const assets: Asset[] = JOBS.map((job): Asset => {
    return {
        classNames: 'job',
        href: url === job.href ? '#metadata' : job.href,
        logo: job.logo,
        transitionName: url === job.href ? '' : job.transitionName,
        alt: job.name
    }
})
---

<Layout
        title={`Frank Romaña - Experience at ${name}`}
        description="Frank Romaña is a software engineer with a passion for building user-friendly, accessible, and performant web applications. Focused on building innovative solutions."
        bgSrc=`${backgroundUrl}`
        bgTitle={`Frank Romaña - Experience at ${name}`}>
    <main>
        <Metadata>
            <img transition:animate={fade({duration: '0.5s'})} class="logo" transition:name={transitionName} src={logo}
                 alt={name}/>
            <h3>{name + ' // ' + roles.join(' / ')}</h3>
            <p>{description}</p>
            <div class="tags">
                {tags.map((tag) =>
                        <Tag text={tag}/>
                )}
            </div>
        </Metadata>
        <Carousel assets={assets}/>
    </main>
</Layout>

<style>
    main {
        width: 100%;
        height: 100%;
        grid-row: 1;
        grid-column: 1;

        padding: 1.625rem;
    }

    @media (width >= 576px) {
        main {
            padding: 0 4rem;
        }
    }

    @media (width >= 992px) {
        main {
            padding: 0 6rem;
        }
    }

    @media (width >= 1200px) {
        main {
            padding: 0 8rem;
        }
    }

    @media (width >= 1440px) {
        main {
            padding: 0 15rem;
        }
    }
</style>